<!DOCTYPE html> <html lang="es"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous"> <link rel="stylesheet" href="/assets/main.css"> <link rel="canonical" href="http://0.0.0.0:4000/2022/11/14/publicar-feed-mastodon.html"> <link rel="alternate" type="application/rss+xml" title="Si lo haces, hazlo bien" href="/feed.xml"> <!-- --> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Publicar feed en Mastodon / Twitter | Si lo haces, hazlo bien</title> <meta name="generator" content="Jekyll v4.3.1" /> <meta property="og:title" content="Publicar feed en Mastodon / Twitter" /> <meta name="author" content="Victor Santos" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Descubri a traves del Blog de Lazaro, que si tienes cuenta en Mastodon, quien no tiene cuenta ahora tal como van las cosas en Twitter, que podias enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web." /> <meta property="og:description" content="Descubri a traves del Blog de Lazaro, que si tienes cuenta en Mastodon, quien no tiene cuenta ahora tal como van las cosas en Twitter, que podias enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web." /> <link rel="canonical" href="http://0.0.0.0:4000/2022/11/14/publicar-feed-mastodon.html" /> <meta property="og:url" content="http://0.0.0.0:4000/2022/11/14/publicar-feed-mastodon.html" /> <meta property="og:site_name" content="Si lo haces, hazlo bien" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2022-11-14T00:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Publicar feed en Mastodon / Twitter" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Victor Santos"},"dateModified":"2022-11-14T00:00:00+00:00","datePublished":"2022-11-14T00:00:00+00:00","description":"Descubri a traves del Blog de Lazaro, que si tienes cuenta en Mastodon, quien no tiene cuenta ahora tal como van las cosas en Twitter, que podias enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web.","headline":"Publicar feed en Mastodon / Twitter","mainEntityOfPage":{"@type":"WebPage","@id":"http://0.0.0.0:4000/2022/11/14/publicar-feed-mastodon.html"},"url":"http://0.0.0.0:4000/2022/11/14/publicar-feed-mastodon.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <header id="nav-header" class="border-dark border-left-0 border-right-0"> <div id="nav-container" class="container position-relative d-flex justify-content-between align-items-center"> <a class="h4 m-0 text-dark" href="/">Si lo haces, hazlo bien</a> <nav id="nav-menu-container" class="text-right navbar-light"> <input type="checkbox" id="nav-trigger" class="d-none"/> <label for="nav-trigger" aria-label="button" class="m-2 d-inline-block d-md-none navbar-toggler-icon"> </label> <div id="nav-menu" class="d-none d-md-block"> <a class="text-dark ml-3 ml-md-0 p-2 d-block d-md-inline-block" href="/about/">About</a> <a class="text-dark ml-3 ml-md-0 p-2 d-block d-md-inline-block" href="/posts/">Posts</a> </div> </nav> </div> </header> <main aria-label="Content"> <div id="content-container" class="container"> <article itemscope itemtype="http://schema.org/BlogPosting"> <header class="pt-4 pb-3"> <h1 itemprop="name headline">Publicar feed en Mastodon / Twitter</h1> <p class="text-secondary"> <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Victor Santos</span></span> &bull; <time datetime="2022-11-14T00:00:00+00:00" itemprop="datePublished"> Nov 14, 2022 </time> </p> </header> <div class="text-justify" itemprop="articleBody" id="content"> <p>Descubri a traves del <a href="https://elblogdelazaro.org">Blog de Lazaro</a>, que si tienes cuenta en <code class="language-plaintext highlighter-rouge">Mastodon</code>, quien no tiene cuenta ahora tal como van las cosas en <code class="language-plaintext highlighter-rouge">Twitter</code>, que podias enviar de forma aleatoria alguno de los articulos que tienes publicados en tu web.</p> <!--more--> <p>Asi que después de leer su articulo y ver si yo podia hacer lo mismo, me lie la manta a la cabeza y al lio.</p> <p>Lo primero, es tener una cuenta y después tienes que crear un aplicación en <code class="language-plaintext highlighter-rouge">Mastodon</code> de igual forma que se puede crear en Twitter ( explicación más adelante ).</p> <p>Aprovechando que en el servidor ya tengo Python instalado, hare que se ejecute en el mismo servidor. Eso si, también tienes que instalar:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   usuari@debian:~<span class="nv">$ </span>pip <span class="nb">install</span> <span class="nt">--user</span> feddparser mastodon
</code></pre></div></div> <p>Para que Python pueda realizar el tratamiento del fichero <code class="language-plaintext highlighter-rouge">xml</code>.</p> <p>Una vez que ya tienes la aplicación creada, tienes que crear un fichero en <code class="language-plaintext highlighter-rouge">Python</code> que tiene que tener la siguiente estructura:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="c1">#!/usr/bin/env python
</span>   <span class="c1"># -*- coding: utf-8 -*-
</span> 
   <span class="c1"># el fitxer original es de Carlos M. ( https://elblogdelazaro.org )
</span> 
   <span class="c1"># Tens que tindre instalats les llibreries feedparser, Mastodon
</span> 
   <span class="c1"># Realitzem la crida als moduls de Python
</span>   <span class="kn">import</span> <span class="nn">feedparser</span>
   <span class="kn">import</span> <span class="nn">random</span>
   <span class="kn">from</span> <span class="nn">mastodon</span> <span class="kn">import</span> <span class="n">Mastodon</span>
 
   <span class="c1"># Reallitzem la crida a les claus del Diccionari
</span>   <span class="n">CUSTOMER_KEY</span> <span class="o">=</span> <span class="s">'xxxxxxxxxxxxxxx'</span>
   <span class="n">CUSTOMER_SECRET</span> <span class="o">=</span> <span class="s">'xxxxxxxxxxxxxxxxx'</span>
   <span class="n">ACCESS_TOKEN</span> <span class="o">=</span> <span class="s">'xxxxxxxxxxxx'</span>
   <span class="n">ACCESS_TOKEN_SECRET</span> <span class="o">=</span> <span class="s">'xxxxxxxxxxxxxxxxxxx'</span>
 
   <span class="c1"># Informem de l'adreça del feed
</span>   <span class="n">feed</span> <span class="o">=</span> <span class="s">'tu dirección web hacia el feed.xml'</span>
 
   <span class="c1"># Descodifiquem el feed ( arxiu XML )
</span>   <span class="n">d</span> <span class="o">=</span> <span class="n">feedparser</span><span class="p">.</span><span class="n">parse</span><span class="p">(</span><span class="n">feed</span><span class="p">)</span>
 
   <span class="c1"># Obtenim la longitud del feed i aleatoriament seleccionem un article
</span>   <span class="n">feedlen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s">'entries'</span><span class="p">])</span>
   <span class="n">num</span> <span class="o">=</span> <span class="n">random</span><span class="p">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">feedlen</span><span class="p">)</span>
 
   <span class="c1"># Iniciem l'API de Mastodon, i escribim l'estat
</span>   <span class="n">status_text</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s">'entries'</span><span class="p">][</span><span class="n">num</span><span class="p">][</span><span class="s">'title'</span><span class="p">]</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s">'entries'</span><span class="p">][</span><span class="n">num</span><span class="p">][</span><span class="s">'link'</span><span class="p">]</span>
   <span class="n">articulo</span> <span class="o">=</span> <span class="p">(</span><span class="s">"Recordando artículos publicados:"</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span> <span class="o">+</span> <span class="n">status_text</span><span class="p">)</span>

   <span class="c1"># Token y url de la Instancia
</span>   <span class="n">mastodon</span> <span class="o">=</span> <span class="n">Mastodon</span><span class="p">(</span>
     <span class="n">access_token</span> <span class="o">=</span> <span class="s">'XXXXXXXXXXXXXXXXXXXXXXX'</span><span class="p">,</span>
     <span class="n">api_base_url</span> <span class="o">=</span> <span class="s">'https://mastodon.online/'</span>
   <span class="p">)</span>
   <span class="c1"># Publiquem a Mastodon
</span>   <span class="n">mastodon</span><span class="p">.</span><span class="n">status_post</span><span class="p">(</span><span class="n">articulo</span><span class="p">)</span>
</code></pre></div></div> <p>Lo que tienes que tener en cuenta, es informar correctamente de:</p> <ul> <li><strong>CUSTOMER_KEY</strong></li> <li><strong>CUSTOMER_SECRET</strong></li> <li><strong>ACCESS_TOKEN</strong></li> <li><strong>ACCESS_TOKEN_SECRET</strong></li> <li><strong>feed</strong></li> </ul> <p>Una vez, tengas el fichero creado, si quieres hacer pruebas, tienes que hacerlo de la siguiente manera :</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   usuari@debian:~<span class="nv">$ </span>python3 nombreDelArchivo.py
</code></pre></div></div> <p>Entonces, si no has tenido ningun problema, a tu cuenta de Mastodon te llegara un articulo aleatorio de tu web.</p> <p>Después de hacer las pruebas que creas oportunas, solo te quedara configurar el cron, para que se ejecute cuando tu quieras.</p> <p>Yo lo tengo a que lo haga una vez a la semana, pero me estoy replanteando cambiarlo a que lo haga 3 veces por semana, pero no se si hacerlo, porque entonces, enviaria muchos toot a mastodon y no me gustaria saturar la red de mastodon por unos simples articulos.</p> <p>Para la configuración del <code class="language-plaintext highlighter-rouge">CRON</code> lo tengo de la siguiente manera:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   @weekly /usr/bin/python3 /home/tu_usuario/lugar_donde_tengas_el_script/botMastodonPythonRss.py
</code></pre></div></div> <p>En el caso de que lo quisieras hacer funcionar en <code class="language-plaintext highlighter-rouge">Twitter</code> tienes que tener en cuenta las siguientes modificaciones al archivo de <code class="language-plaintext highlighter-rouge">Python</code>:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="c1"># En vez de usar la libreria "Mastodon" de Python, tienes que usar "Twython"
</span>   <span class="kn">from</span> <span class="nn">twython</span> <span class="kn">import</span> <span class="n">Twython</span>

   <span class="n">api</span> <span class="o">=</span> <span class="n">Twython</span><span class="p">(</span><span class="n">CONSUMER_KEY</span><span class="p">,</span><span class="n">CONSUMER_SECRET</span><span class="p">,</span><span class="n">ACCESS_KEY</span><span class="p">,</span><span class="n">ACCESS_SECRET</span><span class="p">)</span>

</code></pre></div></div> <p>Y luego, solamente tienes que añadir la siguiente linea para publicar el articulo en <code class="language-plaintext highlighter-rouge">Twitter</code>:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="n">api</span><span class="p">.</span><span class="n">update_status</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">articulo</span><span class="p">)</span>
</code></pre></div></div> <p>Espero que te sirva tanto como me ha servido a mi. Y eso si, no se te olvide darle las gracias a <a href="http://elblogdelazaro.org">Carlos M</a> por el increible articulo en que me he basado yo.</p> <h4 id="referencia">Referencia</h4> <ul> <li><a href="https://elblogdelazaro.org/posts/2021-08-16-bot-en-python-para-publicar-un-feed-de-forma-aleatorios-en-twitter-y-mastodom/">Script de Python</a></li> </ul> </div> </article> </div> </main> <footer id="site-footer"> <div class="container"> <div class="h5 pt-4">Si lo haces, hazlo bien</div> <div class="row"> <div class="col col-lg-3"> <ul class="list-unstyled"> <li class="text-secondary"> Vctrsnts </li> </ul> </div> <div class="col-6 col-lg-3"> <ul class="list-unstyled"> <li> <a href="https://github.com/Vctrsnts"> <span class="align-middle text-secondary pr-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><title>GitHub</title><path fill="currentColor" d="M8 .43C3.714.43.24 3.905.24 8.192c0 3.428 2.223 6.337 5.307 7.363.388.07.53-.168.53-.374l-.01-1.32c-2.16.47-2.614-1.04-2.614-1.04-.353-.896-.862-1.135-.862-1.135-.705-.48.053-.472.053-.472.78.055 1.19.8 1.19.8.692 1.186 1.816.843 2.258.645.07-.502.27-.843.493-1.037-1.723-.197-3.534-.862-3.534-3.836 0-.847.302-1.54.8-2.082-.08-.197-.347-.986.076-2.054 0 0 .652-.21 2.134.796A7.39 7.39 0 0 1 8 4.184a7.45 7.45 0 0 1 1.943.261c1.482-1.004 2.132-.796 2.132-.796.423 1.068.157 1.857.077 2.054.497.542.798 1.235.798 2.082 0 2.98-1.814 3.637-3.543 3.83.28.24.527.713.527 1.437l-.01 2.13c0 .208.14.45.534.373 3.08-1.028 5.302-3.935 5.302-7.362C15.76 3.906 12.285.43 8 .43z"/></svg></span><span>Vctrsnts</span> </a> </li> <li> <a href="https://mastodon.online/@vsantos"> <span class="align-middle text-secondary pr-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-mastodon" viewBox="0 0 16 16"> <path d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z"/> </svg></span><span>vsantos</span> </a> </li> <li> <a href="https://twitter.com/Vctrsnts1"> <span class="align-middle text-secondary pr-2"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-twitter" viewBox="0 0 16 16"> <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/> </svg></span><span>Vctrsnts1</span> </a> </li> </ul> </div> <div class="col-12 col-lg"> <p class="text-secondary text-justify">Bienvenido a mi Blog personal. Aqui encontraras tutoriales y notas que voy tomando cuando hago mis instalaciones, configuraciones, pruebas, etc... </p> </div> </div> </div> </footer> </body> </html>
